<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Java-lang : Java Language support" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Java-lang</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/OpenHFT/Java-Lang">View on GitHub</a>

          <h1 id="project_title">Java-lang</h1>
          <h2 id="project_tagline">Java Language support</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/OpenHFT/Java-Lang/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/OpenHFT/Java-Lang/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="javalang" class="anchor" href="#javalang"><span class="octicon octicon-link"></span></a>JavaLang</h1>

<p>This module provides marshalling, de-marshalling and handling of thread safe off heap memory through ByteBuffers.</p>

<p>This module is available on maven central as</p>

<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;net.openhft&lt;/groupId&gt;
    &lt;artifactId&gt;lang&lt;/artifactId&gt;
    &lt;version&gt;6.1.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<p>The version 6.x signifies that it is build for Java 6+. (It requires Java 6 update 18 or later to build)</p>

<h2>
<a name="working-with-off-heap-objects" class="anchor" href="#working-with-off-heap-objects"><span class="octicon octicon-link"></span></a>Working with off heap objects.</h2>

<p>Java-Lang 6.1 adds support for basic off heap data structures.  More collections types and more complex data types will be added in future versions.</p>

<pre><code>public interface DataType {
     // add getters and setters here
}

// can create an array of any size (provided you have the memory) off heap.
HugeArray&lt;DataType&gt; array = HugeCollections.newArray(DataType.class, 10*1000*1000*1000L);
DataType dt = array.get(1111111111);

// set data on dt
array.recycle(dt); // recycle the reference (or discard it)

// create a ring buffer
HugeQueue&lt;DataType&gt; queue = HugeCollections.newQueue(DataType.class, 10*1000*1000L);
// give me a reference to an object to populate
DataType dt2 = queue.offer();
// set the values od dt2
queue.recycle(dt2);

DataType dt3 = queue.take();
// get values
queue.recycle(dt3);
</code></pre>

<p>This is designed to be largely GC-less and you can queue millions of entries with 32 MB heap and not trigger GCs.</p>

<h2>
<a name="working-with-buffers" class="anchor" href="#working-with-buffers"><span class="octicon octicon-link"></span></a>Working with buffers</h2>

<p>To work with buffers there is a several options:</p>

<ul>
<li>
<em>ByteBufferBytes</em> which wraps <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html">java.nio.ByteBuffer</a>
</li>
<li>
<em>DirectBytes</em> which is slices/records of <a href="https://github.com/OpenHFT/Java-Lang/blob/master/lang/src/main/java/net/openhft/lang/io/DirectStore.java">DirectStore</a> - own implementation for offheap storage</li>
</ul><p>Both classes provide functionality:</p>

<ul>
<li>write\read operations for primitives (writeLong(long n), readLong() etc.)</li>
<li>locking in native memory, so you can add thread safe constructs to your native record.</li>
<li>CAS operations for int and long <em>boolean compareAndSwapInt(long offset, int expected, int x)</em>, <em>boolean compareAndSwapLong(long offset, long expected, long x)</em>
</li>
<li>addAndGetInt and getAndAddInt operations</li>
</ul><h4>
<a name="example" class="anchor" href="#example"><span class="octicon octicon-link"></span></a>Example</h4>

<pre><code>ByteBuffer byteBuffer = ByteBuffer.allocate(SIZE);
ByteBufferBytes bytes = new ByteBufferBytes(byteBuffer);
for (long i = 0; i &lt; bytes.capacity(); i++)
    bytes.writeLong(i);
for (long i = bytes.capacity()-8; i &gt;= 0; i -= 8) {
    int j = bytes.readLong(i);
    assert i ==  j;
}
</code></pre>

<h1>
<a name="building-for-eclipse" class="anchor" href="#building-for-eclipse"><span class="octicon octicon-link"></span></a>Building for eclipse</h1>

<p>Download Java-Lang zip from git <a href="https://github.com/OpenHFT/Java-Lang/archive/master.zip">https://github.com/OpenHFT/Java-Lang/archive/master.zip</a></p>

<p>Unzip master.zip, Java-Lang-master folder will be extracted from zip.</p>

<pre><code>cd Java-Lang-master
mvn eclipse:eclipse
</code></pre>

<p>Now you have an eclipse project, import project into Eclipse</p>

<p>If your Eclipse configuration is not UTF-8, after importing the project you may see some errors and strange characters in some .java files. To get rid of this problem change character enconding to UTF-8: project-&gt;properties-&gt;resource-&gt;text file encoding-&gt;utf8</p>

<h3>
<a name="javadoc" class="anchor" href="#javadoc"><span class="octicon octicon-link"></span></a>JavaDoc</h3>

<p>Check out our documentation at <a href="http://openhft.github.io/Java-Lang/apidocs/">JavaDoc</a></p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Java-lang maintained by <a href="https://github.com/OpenHFT">OpenHFT</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
